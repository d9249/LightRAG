# 빠른 시작 가이드

<cite>
**이 문서에서 참조된 파일**   
- [lightrag_openai_demo.py](file://examples/lightrag_openai_demo.py)
- [lightrag_ollama_demo.py](file://examples/lightrag_ollama_demo.py)
- [insert_custom_kg.py](file://examples/insert_custom_kg.py)
- [rerank_example.py](file://examples/rerank_example.py)
- [lightrag_server.py](file://lightrag/api/lightrag_server.py)
- [lightrag_webui](file://lightrag_webui)
- [lightrag.py](file://lightrag/lightrag.py)
</cite>

## 목차
1. [소개](#소개)
2. [Python 라이브러리 사용법](#python-라이브러리-사용법)
3. [Ollama와 같은 로컬 LLM 사용](#ollama와-같은-로컬-llm-사용)
4. [웹 UI를 통한 빠른 사용법](#웹-ui를-통한-빠른-사용법)
5. [사용자 지정 지식 그래프 삽입](#사용자-지정-지식-그래프-삽입)
6. [리랭킹 기능](#리랭킹-기능)
7. [결론](#결론)

## 소개
LightRAG는 초보자도 쉽게 사용할 수 있는 검색 증강 생성(RAG) 시스템입니다. 이 가이드에서는 Python 라이브러리와 웹 UI를 통해 LightRAG의 핵심 기능을 빠르게 체험하는 방법을 안내합니다. 문서 삽입, 쿼리 실행, 결과 확인의 전체 흐름을 코드 예제와 함께 설명하며, Ollama와 같은 로컬 LLM을 사용하는 경우의 설정 차이점도 안내합니다.

## Python 라이브러리 사용법
Python 라이브러리를 사용하여 LightRAG의 기본 기능을 체험할 수 있습니다. `examples/lightrag_openai_demo.py` 파일을 기반으로 문서 삽입, 쿼리 실행, 결과 확인의 전체 흐름을 설명합니다.

### 문서 삽입
문서를 LightRAG에 삽입하기 위해 `ainsert` 메서드를 사용합니다. 이 메서드는 비동기적으로 작동하며, 삽입된 문서는 지식 그래프로 변환됩니다.

```python
await rag.ainsert(f.read())
```

**기대되는 출력**
```
Deleting old file:: ./dickens/kv_store_doc_status.json
Deleting old file:: ./dickens/kv_store_full_docs.json
...
```

**일반적인 오류**
- `OPENAI_API_KEY environment variable is not set`: OpenAI API 키가 설정되지 않았을 경우 발생합니다. `.env` 파일이나 환경 변수에 `OPENAI_API_KEY`를 설정해야 합니다.

### 쿼리 실행
쿼리 모드는 `naive`, `local`, `global`, `hybrid` 네 가지가 있습니다. 각 모드는 서로 다른 방식으로 검색 결과를 생성합니다.

```python
print(await rag.aquery("What are the top themes in this story?", param=QueryParam(mode="naive")))
```

**기대되는 출력**
```
=====================
Query mode: naive
=====================
The top themes in this story include...
```

**일반적인 오류**
- `An error occurred: ...`: 쿼리 실행 중 오류가 발생했을 경우 출력됩니다. 로그 파일을 확인하여 자세한 오류 원인을 파악할 수 있습니다.

### 결과 확인
쿼리 결과는 텍스트 형식으로 출력되며, 각 쿼리 모드에 따라 결과의 정확도와 관련성이 다릅니다. `hybrid` 모드는 일반적으로 가장 정확한 결과를 제공합니다.

**기대되는 출력**
```
=====================
Query mode: hybrid
=====================
The most prominent themes in this narrative are...
```

**일반적인 오류**
- `No response generated`: 결과가 생성되지 않았을 경우 발생합니다. 입력 문서의 내용이 부족하거나 쿼리가 모호할 수 있습니다.

**Section sources**
- [lightrag_openai_demo.py](file://examples/lightrag_openai_demo.py#L100-L189)

## Ollama와 같은 로컬 LLM 사용
Ollama와 같은 로컬 LLM을 사용하면 외부 API에 의존하지 않고도 LightRAG를 실행할 수 있습니다. 설정 차이점은 LLM 모델 함수와 임베딩 함수를 변경하는 것입니다.

### 설정 변경
`lightrag_ollama_demo.py` 파일을 사용하여 Ollama를 설정합니다. 주요 설정은 다음과 같습니다.

```python
rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=ollama_model_complete,
    llm_model_name=os.getenv("LLM_MODEL", "qwen2.5-coder:7b"),
    embedding_func=EmbeddingFunc(
        embedding_dim=int(os.getenv("EMBEDDING_DIM", "1024")),
        func=lambda texts: ollama_embed(
            texts,
            embed_model=os.getenv("EMBEDDING_MODEL", "bge-m3:latest"),
            host=os.getenv("EMBEDDING_BINDING_HOST", "http://localhost:11434"),
        ),
    ),
)
```

**기대되는 출력**
```
LightRAG compatible demo log file: ./lightrag_ollama_demo.log
...
=====================
Query mode: local
=====================
The primary themes discussed in this story are...
```

**일반적인 오류**
- `Failed to connect to Ollama server`: Ollama 서버에 연결할 수 없을 경우 발생합니다. Ollama 서버가 실행 중인지 확인하고, `host` 설정이 올바른지 확인해야 합니다.
- `Model not found`: 지정된 모델이 Ollama에 존재하지 않을 경우 발생합니다. `ollama list` 명령어로 사용 가능한 모델을 확인할 수 있습니다.

**Section sources**
- [lightrag_ollama_demo.py](file://examples/lightrag_ollama_demo.py#L100-L217)

## 웹 UI를 통한 빠른 사용법
웹 UI를 통해 LightRAG를 더 쉽게 사용할 수 있습니다. 문서 업로드, 검색 테스트, 그래프 시각화 기능을 제공합니다.

### 문서 업로드
웹 UI의 문서 관리 기능을 통해 문서를 업로드할 수 있습니다. 업로드된 문서는 자동으로 처리되어 지식 그래프에 추가됩니다.

**기대되는 출력**
- 문서 업로드 후, 처리 상태가 "완료"로 표시됩니다.
- 업로드된 문서 목록에서 문서 이름과 상태를 확인할 수 있습니다.

**일반적인 오류**
- `Upload failed`: 문서 업로드에 실패했을 경우 발생합니다. 파일 크기가 너무 크거나 형식이 지원되지 않을 수 있습니다.

### 검색 테스트
웹 UI의 검색 기능을 통해 쿼리를 입력하고 결과를 확인할 수 있습니다. 쿼리 모드를 선택하여 다양한 검색 결과를 비교할 수 있습니다.

**기대되는 출력**
- 검색 결과가 텍스트 형식으로 표시됩니다.
- 각 결과의 관련성 점수가 함께 표시됩니다.

**일반적인 오류**
- `No results found`: 검색 결과가 없을 경우 발생합니다. 쿼리를 수정하거나 다른 모드를 시도해 보세요.

### 그래프 시각화
지식 그래프를 시각화하여 엔터티와 관계를 직관적으로 확인할 수 있습니다. 노드와 엣지를 클릭하여 세부 정보를 확인할 수 있습니다.

**기대되는 출력**
- 지식 그래프가 웹 브라우저에 표시됩니다.
- 노드와 엣지의 레이블을 확인할 수 있습니다.

**일반적인 오류**
- `Graph rendering failed`: 그래프 렌더링에 실패했을 경우 발생합니다. 브라우저 호환성 문제일 수 있으므로 다른 브라우저를 사용해 보세요.

**Section sources**
- [lightrag_webui](file://lightrag_webui)
- [lightrag_server.py](file://lightrag/api/lightrag_server.py#L200-L800)

## 사용자 지정 지식 그래프 삽입
사용자 지정 지식 그래프를 삽입하여 기존 지식 그래프를 확장할 수 있습니다. `insert_custom_kg.py` 파일을 사용하여 사용자 지정 지식 그래프를 삽입합니다.

### 예제 코드
```python
custom_kg = {
    "entities": [
        {
            "entity_name": "CompanyA",
            "entity_type": "Organization",
            "description": "A major technology company",
            "source_id": "Source1",
        },
        ...
    ],
    "relationships": [
        {
            "src_id": "CompanyA",
            "tgt_id": "ProductX",
            "description": "CompanyA develops ProductX",
            "keywords": "develop, produce",
            "weight": 1.0,
            "source_id": "Source1",
        },
        ...
    ],
    "chunks": [
        {
            "content": "ProductX, developed by CompanyA, has revolutionized the market with its cutting-edge features.",
            "source_id": "Source1",
            "source_chunk_index": 0,
        },
        ...
    ],
}

rag.insert_custom_kg(custom_kg)
```

**기대되는 출력**
```
Inserting custom knowledge graph...
Custom knowledge graph inserted successfully.
```

**일반적인 오류**
- `Invalid entity format`: 엔터티 형식이 올바르지 않을 경우 발생합니다. 엔터티 이름과 설명이 누락되었는지 확인하세요.
- `Relationship source not found`: 관계의 소스 엔터티가 존재하지 않을 경우 발생합니다. 엔터티 이름이 올바른지 확인하세요.

**Section sources**
- [insert_custom_kg.py](file://examples/insert_custom_kg.py#L0-L115)

## 리랭킹 기능
리랭킹 기능을 사용하여 검색 결과의 품질을 향상시킬 수 있습니다. `rerank_example.py` 파일을 사용하여 리랭킹 기능을 체험할 수 있습니다.

### 예제 코드
```python
rag = LightRAG(
    working_dir=WORKING_DIR,
    llm_model_func=llm_model_func,
    embedding_func=EmbeddingFunc(
        embedding_dim=embedding_dim,
        max_token_size=8192,
        func=embedding_func,
    ),
    rerank_model_func=rerank_model_func,
)
```

**기대되는 출력**
```
🚀 Setting up LightRAG with Rerank functionality...
📄 Inserting sample documents...
🔍 Testing query: 'How does reranking improve retrieval quality?'
📊 Testing with enable_rerank=True (default):
   Result length: 1234 characters
   Preview: Reranking improves retrieval quality by re-ordering...
```

**일반적인 오류**
- `Rerank API error`: 리랭킹 API 호출에 실패했을 경우 발생합니다. API 키와 엔드포인트가 올바른지 확인하세요.
- `Empty results`: 리랭킹 결과가 비어 있을 경우 발생합니다. 쿼리와 문서의 관련성을 확인하세요.

**Section sources**
- [rerank_example.py](file://examples/rerank_example.py#L0-L232)

## 결론
이 가이드를 통해 LightRAG의 핵심 기능을 빠르게 체험할 수 있었습니다. Python 라이브러리와 웹 UI를 통해 문서 삽입, 쿼리 실행, 결과 확인의 전체 흐름을 이해했으며, Ollama와 같은 로컬 LLM을 사용하는 방법도 안내했습니다. 사용자 지정 지식 그래프 삽입과 리랭킹 기능을 통해 더 정교한 검색 시스템을 구축할 수 있습니다.